{"version":3,"sources":["../src/index.test.js"],"names":["encodeCallScript","callscriptUtils","APP_NAMESPACE_HASH","CORE_NAMESPACE_HASH","test","beforeEach","t","apmCoreStub","getApmInternalAppInfo","sinon","stub","aragonOSCoreStub","getAragonOsInternalAppInfo","configurationStub","setConfiguration","ensStub","resolve","messengerConstructorStub","signals","rpcSignals","utilsStub","AsyncRequestCache","getCacheKey","addressesEqual","Object","is","callscript","forwarding","forwardingUtils","makeAddressMapProxy","fake","returns","makeProxy","transactions","transactionsUtils","Aragon","proxyquire","noCallThru","load","apps","assign","apm","configurationKeys","default","createAragon","daoAddress","options","ensRegistryAddress","context","afterEach","always","restore","plan","app","not","undefined","badDaoAddress","instance","kernelProxyCallStub","withArgs","throws","kernelProxy","address","call","throwsAsync","init","instanceOf","Error","message","truthy","calledTwice","calledWith","FORCE_LOCAL_STORAGE","SUBSCRIPTION_EVENT_DELAY","cache","forceLocalStorage","events","subscriptionEventDelay","initAccounts","providedAccounts","accounts","getAccounts","deepEqual","web3","eth","resolves","fetchFromWeb3","testNetworkId","testNetworkType","net","getId","getNetworkType","initNetwork","network","subscribe","id","type","aclEvents","event","returnValues","role","allowed","entity","manager","get","set","aclProxyStub","pastEvents","initAcl","Promise","permissions","value","counter","add","allowedEntities","subtract","defaultAclAddress","kernelProxyStub","calledOnceWith","givenAclAddress","aclAddress","notCalled","neverCalledWith","kernelAddress","appInitTestCases","forEach","testName","permissionsObj","appIds","codeAddresses","keys","proxyStub","abi","isAragonOsInternalApp","returnsArg","fetchLatestRepoContentForContract","appId","initApps","pipe","codeAddress","proxyAddress","isForwarder","setAppEventStub","Subject","next","namespace","setTimeout","updated","initAppIdentifiers","appIdentifiers","setAppIdentifier","initIdentityProviders","identityProviderRegistrar","true","Map","size","expectedAddress","identityIntents","intent","providerName","requestAddressIdentityModification","all","then","val","reject","initForwarders","forwarders","messageToSign","requestingApp","signatures","signMessage","key","initialAddress","targetAddress","transaction","to","Array","isArray","path","length","performTransactionPath","calculateTransactionPath","catch","err","targetMethodJsonDescription","name","targetParams","mockPath","data","getTransactionPath","externalPath","getExternalTransactionPath","mockTransaction","describeTransactionPath","createDirectTransaction","requestsStub","method","params","messengerStub","sendResponse","requests","makeProxyFromAppABI","updateInitializationBlock","initializationBlock","connect","runApp","result","shutdown","shutdownAndClearCache","getCall","args","ReplaySubject","callCount","runningProxyAddress","getAll","every","startsWith","getApp","getPermissionManager","script","decodedScript","decodeTransactionPath","initAppMetadata","appMetadata","console","log","registerAppMetadata","from","dataId","cid","initForwardedActions","forwardedActions","target","setForwardedAction","currentApp","actionId","blockNumber","Number","POSITIVE_INFINITY","evmScript","status","completedActionKeys","failedActionKeys","pendingActionKeys","actions","newScript","babaAddress","babaScript","babaStored","cacheBlockHeight","dadaAddress","dadaScript","eaeaAddress","eaeaScript","fafaAddress","fafaScript","dadaStored","eaeaStored","fafaStored","notDeepEqual","children","nestedScript","substring","nestedScriptDataLength","toString","padStart","badSpecId","trigger","origin","frontendEvent","testval","triggerAppStore"],"mappings":"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","sourcesContent":["import test from 'ava'\nimport sinon from 'sinon'\nimport proxyquire from 'proxyquire'\nimport { empty, from, of, ReplaySubject, Subject } from 'rxjs'\nimport { first } from 'rxjs/operators'\nimport { signals as rpcSignals } from '@aragon/rpc-messenger'\n\nimport * as apps from './apps'\nimport * as configurationKeys from './configuration/keys'\nimport * as apm from './core/apm'\nimport { getCacheKey } from './utils'\nimport AsyncRequestCache from './utils/AsyncRequestCache'\nimport * as callscriptUtils from './utils/callscript'\nimport * as forwardingUtils from './utils/forwarding'\nimport * as transactionsUtils from './utils/transactions'\n\nconst { encodeCallScript } = callscriptUtils\n\n// soliditySha3('app')\nconst APP_NAMESPACE_HASH = '0xf1f3eb40f5bc1ad1344716ced8b8a0431d840b5783aea1fd01786bc26f35ac0f'\n// soliditySha3('core')\nconst CORE_NAMESPACE_HASH = '0xc681a85306374a5ab27f0bbc385296a54bcd314a1948b6cf61c4ea1bc44bb9f8'\n\ntest.beforeEach(t => {\n  const apmCoreStub = {\n    getApmInternalAppInfo: sinon.stub()\n  }\n  const aragonOSCoreStub = {\n    getAragonOsInternalAppInfo: sinon.stub()\n  }\n  const configurationStub = {\n    setConfiguration: sinon.stub()\n  }\n  const ensStub = {\n    resolve: sinon.stub()\n  }\n  const messengerConstructorStub = sinon.stub()\n  messengerConstructorStub.signals = rpcSignals\n  const utilsStub = {\n    AsyncRequestCache,\n    getCacheKey,\n    addressesEqual: Object.is,\n    callscript: callscriptUtils,\n    forwarding: forwardingUtils,\n    makeAddressMapProxy: sinon.fake.returns({}),\n    makeProxy: sinon.stub(),\n    transactions: transactionsUtils\n  }\n  const Aragon = proxyquire.noCallThru().load('./index', {\n    '@aragon/rpc-messenger': messengerConstructorStub,\n    './apps': apps,\n    './core/aragonOS': aragonOSCoreStub,\n    './core/apm': Object.assign(apm, apmCoreStub),\n    './configuration': configurationStub,\n    './configuration/keys': configurationKeys,\n    './ens': () => ensStub,\n    './utils': utilsStub\n  }).default\n\n  // Helper for creating Aragon class instances\n  function createAragon (daoAddress = '0x00', options) {\n    return new Aragon(daoAddress, {\n      apm: {\n        ensRegistryAddress: '0x00'\n      },\n      ...options\n    })\n  }\n\n  t.context = {\n    Aragon,\n    apmCoreStub,\n    aragonOSCoreStub,\n    createAragon,\n    configurationStub,\n    ensStub,\n    messengerConstructorStub,\n    utilsStub\n  }\n})\n\ntest.afterEach.always(() => {\n  sinon.restore()\n})\n\ntest('should create an Aragon instance with no options given', t => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // act\n  const app = createAragon()\n  // assert\n  t.not(app.apm, undefined)\n})\n\ntest('should throw on init if daoAddress is not a Kernel', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const badDaoAddress = '0xbaddao'\n  const instance = createAragon(badDaoAddress)\n  // web3 will throw if a bad address ('0x') comes back\n  const kernelProxyCallStub = sinon.stub().withArgs('acl').throws()\n  instance.kernelProxy = {\n    address: badDaoAddress,\n    call: kernelProxyCallStub\n  }\n\n  // act and assert\n  await t.throwsAsync(\n    instance.init(),\n    {\n      instanceOf: Error,\n      message: `Provided daoAddress is not a DAO`\n    }\n  )\n})\n\ntest('should set the default configuration', t => {\n  const { createAragon, configurationStub } = t.context\n\n  t.plan(4)\n  // act\n  const instance = createAragon()\n  // assert\n  t.truthy(configurationStub.setConfiguration.calledTwice)\n  t.truthy(\n    configurationStub.setConfiguration.calledWith(configurationKeys.FORCE_LOCAL_STORAGE, false)\n  )\n  t.truthy(\n    configurationStub.setConfiguration.calledWith(configurationKeys.SUBSCRIPTION_EVENT_DELAY, 0)\n  )\n  t.not(instance.apm, undefined)\n})\n\ntest('should set the given configuration', t => {\n  const { createAragon, configurationStub } = t.context\n\n  t.plan(4)\n  // act\n  const instance = createAragon('0x00', {\n    cache: { forceLocalStorage: true },\n    events: { subscriptionEventDelay: 1000 }\n  })\n  // assert\n  t.truthy(configurationStub.setConfiguration.calledTwice)\n  t.truthy(\n    configurationStub.setConfiguration.calledWith(configurationKeys.FORCE_LOCAL_STORAGE, true)\n  )\n  t.truthy(\n    configurationStub.setConfiguration.calledWith(configurationKeys.SUBSCRIPTION_EVENT_DELAY, 1000)\n  )\n  t.not(instance.apm, undefined)\n})\n\ntest(\"should set the default configuration if overriding configuration doesn't contain keys\", t => {\n  const { createAragon, configurationStub } = t.context\n\n  t.plan(4)\n  // act\n  const instance = createAragon('0x00', {\n    cache: {},\n    events: {}\n  })\n  // assert\n  t.truthy(configurationStub.setConfiguration.calledTwice)\n  t.truthy(\n    configurationStub.setConfiguration.calledWith(configurationKeys.FORCE_LOCAL_STORAGE, false)\n  )\n  t.truthy(\n    configurationStub.setConfiguration.calledWith(configurationKeys.SUBSCRIPTION_EVENT_DELAY, 0)\n  )\n  t.not(instance.apm, undefined)\n})\n\ntest('should use provided accounts', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  // act\n  await instance.initAccounts({ providedAccounts: ['0x00'] })\n  const accounts = await instance.getAccounts()\n  // assert\n  t.deepEqual(accounts, ['0x00'])\n})\n\ntest('should get the accounts from web3', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  instance.web3 = {\n    eth: {\n      getAccounts: sinon.stub().resolves(['0x01', '0x02'])\n    }\n  }\n  // act\n  await instance.initAccounts({ fetchFromWeb3: true })\n  const accounts = await instance.getAccounts()\n  // assert\n  t.deepEqual(accounts, ['0x01', '0x02'])\n})\n\ntest('should not fetch the accounts if not asked', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  instance.web3 = {\n    eth: {\n      getAccounts: sinon.stub().resolves(['0x01', '0x02'])\n    }\n  }\n  // act\n  await instance.initAccounts({ fetchFromWeb3: false })\n  const accounts = await instance.getAccounts()\n  // assert\n  t.deepEqual(accounts, [])\n})\n\ntest('should get the network details from web3', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  const testNetworkId = 4\n  const testNetworkType = 'rinkeby'\n  instance.web3 = {\n    eth: {\n      net: {\n        getId: sinon.stub().resolves(testNetworkId),\n        getNetworkType: sinon.stub().resolves(testNetworkType)\n      }\n    }\n  }\n  // act\n  await instance.initNetwork()\n  // assert\n  instance.network.subscribe(network => {\n    t.deepEqual(network, {\n      id: testNetworkId,\n      type: testNetworkType\n    })\n  })\n})\n\nconst aclEvents = from([{\n  event: 'SetPermission',\n  returnValues: {\n    app: 'counter',\n    role: 'add',\n    allowed: true,\n    entity: '0x1'\n  }\n}, {\n  event: 'SetPermission',\n  returnValues: {\n    app: 'counter',\n    role: 'subtract',\n    allowed: true,\n    entity: '0x1'\n  }\n}, {\n  event: 'SetPermission',\n  returnValues: {\n    app: 'counter',\n    role: 'add',\n    allowed: true,\n    entity: '0x2'\n  }\n}, {\n  event: 'SetPermission',\n  returnValues: {\n    app: 'counter',\n    role: 'subtract',\n    allowed: true,\n    entity: '0x2'\n  }\n}, {\n  // Simulate real world mixed order of event types\n  event: 'ChangePermissionManager',\n  returnValues: {\n    app: 'counter',\n    role: 'subtract',\n    manager: 'manager'\n  }\n}, {\n  event: 'SetPermission',\n  returnValues: {\n    app: 'counter',\n    role: 'subtract',\n    allowed: false,\n    entity: '0x2'\n  }\n}, {\n  // duplicate, should not affect the final result because we use a Set\n  event: 'SetPermission',\n  returnValues: {\n    app: 'counter',\n    role: 'subtract',\n    allowed: false,\n    entity: '0x2'\n  }\n}])\n\ntest('should init the ACL correctly', async (t) => {\n  const { createAragon, utilsStub } = t.context\n\n  t.plan(1)\n\n  const instance = createAragon()\n  instance.kernelProxy = {\n    call: sinon.stub()\n  }\n  instance.cache.get = sinon.stub().returns({})\n  instance.cache.set = sinon.stub().resolves()\n\n  const aclProxyStub = {\n    events: sinon.stub().returns(aclEvents),\n    pastEvents: sinon.stub().returns(empty())\n  }\n  utilsStub.makeProxy.returns(aclProxyStub)\n  // act\n  await instance.initAcl()\n  // assert, tell ava to wait for the permissions observable to debounce\n  return new Promise(resolve => {\n    instance.permissions.subscribe(value => {\n      t.deepEqual(value, {\n        counter: {\n          add: {\n            allowedEntities: ['0x1', '0x2']\n          },\n          subtract: {\n            allowedEntities: ['0x1'],\n            manager: 'manager'\n          }\n        }\n      })\n      // The permissions observable debounces, so we should only get one value back\n      resolve()\n    })\n  })\n})\n\ntest('should init the acl with the default acl fetched from the kernel by default', async (t) => {\n  const { createAragon, utilsStub } = t.context\n\n  t.plan(2)\n  // arrange\n  const defaultAclAddress = '0x321'\n  const aclProxyStub = {\n    events: sinon.stub().returns(aclEvents),\n    pastEvents: sinon.stub().returns(empty())\n  }\n\n  const kernelProxyStub = {\n    call: sinon.stub()\n      .withArgs('acl').resolves(defaultAclAddress)\n  }\n  utilsStub.makeProxy\n    .returns(kernelProxyStub)\n    .withArgs(defaultAclAddress).returns(aclProxyStub)\n\n  const instance = createAragon()\n  instance.cache.get = sinon.stub().returns({})\n  instance.cache.set = sinon.stub().resolves()\n\n  // act\n  await instance.initAcl()\n  // assert\n  t.truthy(kernelProxyStub.call.calledOnceWith('acl'))\n  t.truthy(utilsStub.makeProxy.calledWith(defaultAclAddress))\n})\n\ntest('should init the acl with the provided acl', async (t) => {\n  const { createAragon, utilsStub } = t.context\n\n  t.plan(3)\n  // arrange\n  const defaultAclAddress = '0x321'\n  const givenAclAddress = '0x123'\n  const aclProxyStub = {\n    events: sinon.stub().returns(aclEvents),\n    pastEvents: sinon.stub().returns(empty())\n  }\n  const kernelProxyStub = {\n    call: sinon.stub()\n      .withArgs('acl').resolves(defaultAclAddress)\n  }\n  utilsStub.makeProxy\n    .returns(kernelProxyStub)\n    .withArgs(givenAclAddress).returns(aclProxyStub)\n\n  const instance = createAragon()\n  instance.cache.get = sinon.stub().returns({})\n  instance.cache.set = sinon.stub().resolves()\n\n  // act\n  await instance.initAcl({ aclAddress: givenAclAddress })\n  // assert\n  t.truthy(kernelProxyStub.call.notCalled)\n  t.truthy(utilsStub.makeProxy.neverCalledWith(defaultAclAddress))\n  t.truthy(utilsStub.makeProxy.calledWith(givenAclAddress))\n})\n\nconst kernelAddress = '0x123'\nconst appInitTestCases = [\n  [\n    'with kernel in permissions',\n    {\n      [kernelAddress]: 'some permissions',\n      '0x456': 'some permissions',\n      '0x789': 'some permissions',\n      '0xrepo': 'some permissions'\n    }\n  ],\n  [\n    'without kernel in permissions',\n    {\n      '0x456': 'some permissions',\n      '0x789': 'some permissions',\n      '0xrepo': 'some permissions'\n    }\n  ]\n]\nappInitTestCases.forEach(([testName, permissionsObj]) => {\n  test(`should init the apps correctly - ${testName}`, async (t) => {\n    const { createAragon, aragonOSCoreStub, apmCoreStub, ensStub, utilsStub } = t.context\n\n    t.plan(1)\n    // arrange\n    const kernelAddress = '0x123'\n    const appIds = {\n      [kernelAddress]: 'kernel',\n      '0x456': 'counterApp',\n      '0x789': 'votingApp',\n      '0xrepo': 'repoApp'\n    }\n    const codeAddresses = {\n      [kernelAddress]: '0xkernel',\n      '0x456': '0xcounterApp',\n      '0x789': '0xvotingApp',\n      '0xrepo': '0xrepoApp'\n    }\n    // Stub makeProxy for each app\n    Object.keys(appIds).forEach(address => {\n      const proxyStub = {\n        call: sinon.stub()\n      }\n      proxyStub.call\n        .withArgs('kernel').resolves(kernelAddress)\n        .withArgs('appId').resolves(appIds[address])\n        .withArgs('implementation').resolves(codeAddresses[address])\n        .withArgs('isForwarder').resolves(false)\n\n      utilsStub.makeProxy\n        .withArgs(address).returns(proxyStub)\n    })\n    aragonOSCoreStub.getAragonOsInternalAppInfo.withArgs(appIds[kernelAddress]).returns({\n      abi: 'abi for kernel',\n      isAragonOsInternalApp: true\n    })\n    apmCoreStub.getApmInternalAppInfo.withArgs(appIds['0xrepo']).returns({\n      abi: 'abi for repo'\n    })\n    // Mock ens resolution to just return the appId\n    ensStub.resolve = sinon.stub().returnsArg(0)\n\n    const instance = createAragon()\n    instance.apm = {\n      fetchLatestRepoContentForContract: (appId) => Promise.resolve({\n        abi: `abi for ${appId}`\n      })\n    }\n    instance.permissions = of(permissionsObj)\n    instance.kernelProxy = {\n      address: kernelAddress,\n      call: sinon.stub().withArgs('KERNEL_APP_ID').resolves('kernel'),\n      events: sinon.stub().returns(empty())\n    }\n\n    // act\n    await instance.initApps()\n\n    // assert\n    // Check value of apps\n    return new Promise(resolve => {\n      instance.apps.pipe(first()).subscribe(value => {\n        t.deepEqual(value, [\n          {\n            abi: 'abi for kernel',\n            appId: 'kernel',\n            codeAddress: '0xkernel',\n            isAragonOsInternalApp: true,\n            proxyAddress: '0x123'\n          }, {\n            abi: 'abi for counterApp',\n            appId: 'counterApp',\n            codeAddress: '0xcounterApp',\n            isForwarder: false,\n            kernelAddress: '0x123',\n            proxyAddress: '0x456'\n          }, {\n            abi: 'abi for votingApp',\n            appId: 'votingApp',\n            codeAddress: '0xvotingApp',\n            isForwarder: false,\n            kernelAddress: '0x123',\n            proxyAddress: '0x789'\n          }, {\n            abi: 'abi for repoApp',\n            appId: 'repoApp',\n            codeAddress: '0xrepoApp',\n            isForwarder: false,\n            kernelAddress: '0x123',\n            proxyAddress: '0xrepo'\n          }\n        ])\n        resolve()\n      })\n    })\n  })\n})\n\ntest('should update the apps correctly on SetApp', async (t) => {\n  const { createAragon, aragonOSCoreStub, ensStub, utilsStub } = t.context\n  const setAppEventStub = new Subject()\n\n  t.plan(4)\n  // arrange\n  const kernelAddress = '0x123'\n  const permissionsObj = {\n    '0x456': 'some permissions',\n    '0x789': 'some permissions'\n  }\n  const appIds = {\n    [kernelAddress]: 'kernel',\n    '0x456': 'counterApp',\n    '0x789': 'votingApp'\n  }\n  const codeAddresses = {\n    [kernelAddress]: '0xkernel',\n    '0x456': '0xcounterApp',\n    '0x789': '0xvotingApp'\n  }\n  // Stub makeProxy for each app\n  Object.keys(appIds).forEach(address => {\n    const proxyStub = {\n      call: sinon.stub()\n    }\n    proxyStub.call\n      .withArgs('kernel').resolves(kernelAddress)\n      .withArgs('appId').resolves(appIds[address])\n      .withArgs('implementation').resolves(codeAddresses[address])\n      .withArgs('isForwarder').resolves(false)\n\n    utilsStub.makeProxy\n      .withArgs(address).returns(proxyStub)\n  })\n  aragonOSCoreStub.getAragonOsInternalAppInfo.withArgs(appIds[kernelAddress]).returns({\n    abi: 'abi for kernel',\n    isAragonOsInternalApp: true\n  })\n  // Mock ens resolution to just return the appId\n  ensStub.resolve = sinon.stub().returnsArg(0)\n\n  const instance = createAragon()\n  instance.apm = {\n    fetchLatestRepoContentForContract: (appId) => Promise.resolve({\n      abi: `abi for ${appId}`\n    })\n  }\n  instance.permissions = of(permissionsObj)\n  instance.kernelProxy = {\n    address: kernelAddress,\n    call: sinon.stub().withArgs('KERNEL_APP_ID').resolves('kernel'),\n    events: sinon.stub()\n      .withArgs('SetApp', {})\n      .returns(setAppEventStub)\n  }\n\n  // act\n  await instance.initApps()\n\n  // assert\n  // Check initial value of apps\n  await new Promise(resolve => {\n    instance.apps.pipe(first()).subscribe(value => {\n      t.deepEqual(value, [\n        {\n          abi: 'abi for kernel',\n          appId: 'kernel',\n          codeAddress: '0xkernel',\n          isAragonOsInternalApp: true,\n          proxyAddress: '0x123'\n        }, {\n          abi: 'abi for counterApp',\n          appId: 'counterApp',\n          codeAddress: '0xcounterApp',\n          isForwarder: false,\n          kernelAddress: '0x123',\n          proxyAddress: '0x456'\n        }, {\n          abi: 'abi for votingApp',\n          appId: 'votingApp',\n          codeAddress: '0xvotingApp',\n          isForwarder: false,\n          kernelAddress: '0x123',\n          proxyAddress: '0x789'\n        }\n      ])\n      resolve()\n    })\n  })\n\n  // act\n  setAppEventStub.next({\n    returnValues: {\n      appId: 'counterApp',\n      namespace: APP_NAMESPACE_HASH\n    }\n  })\n  await new Promise(resolve => setTimeout(resolve, 100)) // let the emission propagate\n\n  // assert\n  // Check app has been updated\n  await new Promise(resolve => {\n    instance.apps.pipe(first()).subscribe(value => {\n      t.deepEqual(value, [\n        {\n          abi: 'abi for kernel',\n          appId: 'kernel',\n          codeAddress: '0xkernel',\n          isAragonOsInternalApp: true,\n          proxyAddress: '0x123'\n        }, {\n          abi: 'abi for counterApp',\n          appId: 'counterApp',\n          codeAddress: '0xcounterApp',\n          isForwarder: false,\n          kernelAddress: '0x123',\n          proxyAddress: '0x456',\n          updated: true\n        }, {\n          abi: 'abi for votingApp',\n          appId: 'votingApp',\n          codeAddress: '0xvotingApp',\n          isForwarder: false,\n          kernelAddress: '0x123',\n          proxyAddress: '0x789'\n        }\n      ])\n      resolve()\n    })\n  })\n\n  // act\n  setAppEventStub.next({\n    returnValues: {\n      appId: 'votingApp',\n      namespace: APP_NAMESPACE_HASH\n    }\n  })\n  await new Promise(resolve => setTimeout(resolve, 100)) // let the emission propagate\n\n  // assert\n  // Check correct app has been updated\n  await new Promise(resolve => {\n    instance.apps.pipe(first()).subscribe(value => {\n      t.deepEqual(value, [\n        {\n          abi: 'abi for kernel',\n          appId: 'kernel',\n          codeAddress: '0xkernel',\n          isAragonOsInternalApp: true,\n          proxyAddress: '0x123'\n        }, {\n          abi: 'abi for counterApp',\n          appId: 'counterApp',\n          codeAddress: '0xcounterApp',\n          isForwarder: false,\n          kernelAddress: '0x123',\n          proxyAddress: '0x456'\n        }, {\n          abi: 'abi for votingApp',\n          appId: 'votingApp',\n          codeAddress: '0xvotingApp',\n          isForwarder: false,\n          kernelAddress: '0x123',\n          proxyAddress: '0x789',\n          updated: true\n        }\n      ])\n      resolve()\n    })\n  })\n\n  // act\n  setAppEventStub.next({\n    returnValues: {\n      appId: 'counterApp',\n      namespace: CORE_NAMESPACE_HASH\n    }\n  })\n  await new Promise(resolve => setTimeout(resolve, 100)) // let the emission propagate\n\n  // assert\n  // Check that we filtered the last emission as it wasn't the correct namespace\n  await new Promise(resolve => {\n    instance.apps.pipe(first()).subscribe(value => {\n      t.deepEqual(value, [\n        {\n          abi: 'abi for kernel',\n          appId: 'kernel',\n          codeAddress: '0xkernel',\n          isAragonOsInternalApp: true,\n          proxyAddress: '0x123'\n        }, {\n          abi: 'abi for counterApp',\n          appId: 'counterApp',\n          codeAddress: '0xcounterApp',\n          isForwarder: false,\n          kernelAddress: '0x123',\n          proxyAddress: '0x456'\n        }, {\n          abi: 'abi for votingApp',\n          appId: 'votingApp',\n          codeAddress: '0xvotingApp',\n          isForwarder: false,\n          kernelAddress: '0x123',\n          proxyAddress: '0x789',\n          updated: true\n        }\n      ])\n      resolve()\n    })\n  })\n})\n\ntest('should init the app identifiers correctly', async (t) => {\n  t.plan(1)\n  // arrange\n  const { createAragon } = t.context\n  const instance = createAragon()\n  // act\n  await instance.initAppIdentifiers()\n  // assert\n  instance.appIdentifiers.subscribe(value => {\n    t.deepEqual(value, {})\n  })\n})\n\ntest('should emit reduced app identifiers correctly', async (t) => {\n  t.plan(3)\n  // arrange\n  const { createAragon } = t.context\n  const instance = createAragon()\n  await instance.initAppIdentifiers()\n\n  // act\n  instance.setAppIdentifier('0x123', 'ANT')\n  // assert\n  instance.appIdentifiers.pipe(first()).subscribe(value => {\n    t.deepEqual(value, {\n      '0x123': 'ANT'\n    })\n  })\n\n  // act\n  instance.setAppIdentifier('0x456', 'BNT')\n  // assert\n  instance.appIdentifiers.pipe(first()).subscribe(value => {\n    t.deepEqual(value, {\n      '0x123': 'ANT',\n      '0x456': 'BNT'\n    })\n  })\n\n  // act\n  instance.setAppIdentifier('0x123', 'CNT')\n  // assert\n  instance.appIdentifiers.pipe(first()).subscribe(value => {\n    t.deepEqual(value, {\n      '0x123': 'CNT',\n      '0x456': 'BNT'\n    })\n  })\n})\n\ntest('should init the identity providers correctly', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(3)\n  // arrange\n  const instance = createAragon()\n\n  // act\n  await instance.initIdentityProviders()\n  // assert\n  t.truthy(instance.identityProviderRegistrar)\n  t.true(instance.identityProviderRegistrar instanceof Map)\n  t.is(instance.identityProviderRegistrar.size, 1, 'Should have only one provider')\n})\n\ntest('should emit an intent when requesting address identity modification', async (t) => {\n  const { createAragon } = t.context\n  const expectedAddress = '0x123'\n\n  t.plan(2)\n  // arrange\n  const instance = createAragon()\n\n  // act\n  await instance.initIdentityProviders()\n\n  instance.identityIntents.subscribe(intent => {\n    t.is(intent.address, expectedAddress)\n    t.is(intent.providerName, 'local')\n  })\n\n  instance.requestAddressIdentityModification(expectedAddress)\n})\n\ntest('should be able to resolve intent when requesting address identity modification', async (t) => {\n  const { createAragon } = t.context\n  const expectedAddress = '0x123'\n\n  t.plan(2)\n  // arrange\n  const instance = createAragon()\n\n  // act\n  await instance.initIdentityProviders()\n\n  let counter = 0\n  instance.identityIntents.subscribe(intent => {\n    intent.resolve(counter++)\n  })\n\n  return Promise.all([\n    instance.requestAddressIdentityModification(expectedAddress).then(val => t.is(val, 0)),\n    instance.requestAddressIdentityModification(expectedAddress).then(val => t.is(val, 1))\n  ])\n})\n\ntest('should be able to reject intent when requesting address identity modification', async (t) => {\n  const { createAragon } = t.context\n  const expectedAddress = '0x123'\n\n  t.plan(2)\n  // arrange\n  const instance = createAragon()\n\n  // act\n  await instance.initIdentityProviders()\n\n  let counter = 0\n  instance.identityIntents.subscribe(intent => {\n    if (counter === 0) {\n      intent.reject()\n    } else {\n      intent.reject(new Error('custom error'))\n    }\n    counter++\n  })\n\n  return Promise.all([\n    t.throwsAsync(\n      instance.requestAddressIdentityModification(expectedAddress),\n      {\n        instanceOf: Error,\n        message: 'The identity modification was not completed'\n      }\n    ),\n    t.throwsAsync(\n      instance.requestAddressIdentityModification(expectedAddress),\n      {\n        instanceOf: Error,\n        message: 'custom error'\n      }\n    )\n  ])\n})\n\ntest('should init the forwarders correctly', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  instance.apps = of([\n    {\n      appId: 'counterApp',\n      isForwarder: true\n    }, {\n      appId: 'votingApp',\n      isForwarder: false\n    }\n  ])\n  // act\n  await instance.initForwarders()\n  // assert\n  instance.forwarders.subscribe(value => {\n    t.deepEqual(value, [\n      {\n        appId: 'counterApp',\n        isForwarder: true\n      }\n    ])\n  })\n})\n\ntest('should emit an intent when requesting message signing', async (t) => {\n  const { createAragon } = t.context\n  const messageToSign = 'test message'\n  const requestingApp = '0x123'\n\n  t.plan(2)\n  // arrange\n  const instance = createAragon()\n  instance.signatures = new Subject()\n\n  // act\n  instance.signatures.subscribe(intent => {\n    t.is(intent.message, messageToSign)\n    t.is(intent.requestingApp, requestingApp)\n  })\n\n  instance.signMessage(messageToSign, requestingApp)\n})\n\ntest('should be able to resolve intent when requesting message signing', async (t) => {\n  const { createAragon } = t.context\n  const messageToSign = 'test message'\n  const requestingApp = '0x123'\n\n  t.plan(2)\n  // arrange\n  const instance = createAragon()\n  instance.signatures = new Subject()\n\n  // act\n  let counter = 0\n  instance.signatures.subscribe(intent => {\n    intent.resolve(counter++)\n  })\n\n  return Promise.all([\n    instance.signMessage(messageToSign, requestingApp).then(val => t.is(val, 0)),\n    instance.signMessage(messageToSign, requestingApp).then(val => t.is(val, 1))\n  ])\n})\n\ntest('should be able to reject intent when requesting message signing', async (t) => {\n  const { createAragon } = t.context\n  const messageToSign = 'test message'\n  const requestingApp = '0x123'\n\n  t.plan(2)\n  // arrange\n  const instance = createAragon()\n  instance.signatures = new Subject()\n\n  // act\n  let counter = 0\n  instance.signatures.subscribe(intent => {\n    if (counter === 0) {\n      intent.reject()\n    } else {\n      intent.reject(new Error('custom error'))\n    }\n    counter++\n  })\n\n  return Promise.all([\n    t.throwsAsync(\n      instance.signMessage(messageToSign, requestingApp),\n      {\n        instanceOf: Error,\n        message: 'The message was not signed'\n      }\n    ),\n    t.throwsAsync(\n      instance.signMessage(messageToSign, requestingApp),\n      {\n        instanceOf: Error,\n        message: 'custom error'\n      }\n    )\n  ])\n})\n\ntest('should reject non-string message when requesting message signature', async (t) => {\n  const { createAragon } = t.context\n  const messageToSign = { key: 'this is not a string' }\n  const requestingApp = '0x123'\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n\n  // act\n  return t.throwsAsync(instance.signMessage(messageToSign, requestingApp),\n    {\n      instanceOf: Error,\n      message: 'Message to sign must be a string'\n    }\n  )\n})\n\ntest('should emit an intent when performing transaction path', async (t) => {\n  const { createAragon } = t.context\n  const initialAddress = '0x123'\n  const targetAddress = '0x456'\n\n  t.plan(3)\n  // arrange\n  const instance = createAragon()\n  instance.transactions = new Subject()\n\n  // act\n  instance.transactions.subscribe(intent => {\n    t.deepEqual(intent.transaction, { to: initialAddress })\n    t.true(Array.isArray(intent.path))\n    t.is(intent.path.length, 2)\n  })\n\n  instance.performTransactionPath([{ to: initialAddress }, { to: targetAddress }])\n})\n\ntest('should be able to resolve intent when performing transaction path', async (t) => {\n  const { createAragon } = t.context\n  const initialAddress = '0x123'\n  const targetAddress = '0x456'\n\n  t.plan(2)\n  // arrange\n  const instance = createAragon()\n  instance.transactions = new Subject()\n\n  // act\n  let counter = 0\n  instance.transactions.subscribe(intent => {\n    intent.resolve(counter++)\n  })\n\n  return Promise.all([\n    instance.performTransactionPath([{ to: initialAddress }, { to: targetAddress }]).then(val => t.is(val, 0)),\n    instance.performTransactionPath([{ to: initialAddress }, { to: targetAddress }]).then(val => t.is(val, 1))\n  ])\n})\n\ntest('should be able to reject intent when perform transaction path', async (t) => {\n  const { createAragon } = t.context\n  const initialAddress = '0x123'\n  const targetAddress = '0x456'\n\n  t.plan(2)\n  // arrange\n  const instance = createAragon()\n  instance.transactions = new Subject()\n\n  // act\n  let counter = 0\n  instance.transactions.subscribe(intent => {\n    if (counter === 0) {\n      intent.reject()\n    } else {\n      intent.reject(new Error('custom error'))\n    }\n    counter++\n  })\n\n  return Promise.all([\n    t.throwsAsync(\n      instance.performTransactionPath([{ to: initialAddress }, { to: targetAddress }]),\n      {\n        instanceOf: Error,\n        message: 'The transaction was not signed'\n      }\n    ),\n    t.throwsAsync(\n      instance.performTransactionPath([{ to: initialAddress }, { to: targetAddress }]),\n      {\n        instanceOf: Error,\n        message: 'custom error'\n      }\n    )\n  ])\n})\n\ntest('should throw if no ABI is found, when calculating the transaction path', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  instance.permissions = of({\n    counter: {\n      add: {\n        allowedEntities: ['0x1', '0x2']\n      },\n      subtract: {\n        allowedEntities: ['0x1'],\n        manager: 'im manager'\n      }\n    }\n  })\n  instance.forwarders = of([\n    {\n      appId: 'forwarderA',\n      proxyAddress: '0x999'\n    }\n  ])\n  instance.apps = of([\n    {\n      appId: 'counterApp',\n      kernelAddress: '0x123',\n      abi: 'abi for counterApp',\n      proxyAddress: '0x456'\n    }, {\n      appId: 'votingApp',\n      kernelAddress: '0x123',\n      // abi: 'abi for votingApp',\n      proxyAddress: '0x789'\n    }\n  ])\n  // act\n  return instance.calculateTransactionPath(null, '0x789')\n    .catch(err => {\n      // assert\n      t.is(err.message, 'No ABI specified in artifact for 0x789')\n      /*\n       * Note: This test also \"asserts\" that the permissions object, the app object and the\n       * forwarders array does not throw any errors when they are being extracted from their observables.\n       */\n    })\n})\n\ntest('should use normal transaction pathing when finding external transaction path for installed app', async (t) => {\n  const { createAragon } = t.context\n  const targetAddress = '0x123'\n  const targetMethodJsonDescription = [{ name: 'foo' }]\n  const targetParams = [8]\n  const mockPath = [{ to: '0x123', data: '0x456' }]\n\n  t.plan(2)\n  // arrange\n  const instance = createAragon()\n  instance.accounts = of('0x00')\n  instance.apps = of([\n    {\n      appId: 'counterApp',\n      kernelAddress: '0x789',\n      abi: 'abi for counterApp',\n      proxyAddress: targetAddress\n    }\n  ])\n  instance.getTransactionPath = sinon.stub().returns(mockPath)\n  // act\n  const externalPath = await instance.getExternalTransactionPath(targetAddress, targetMethodJsonDescription, targetParams)\n  // assert\n  t.deepEqual(externalPath, mockPath)\n  t.true(instance.getTransactionPath.calledOnceWith(targetAddress, targetMethodJsonDescription.name, targetParams))\n})\n\ntest('should be able to find external transaction path for non-installed app', async (t) => {\n  const { createAragon, utilsStub } = t.context\n  const targetAddress = '0x123'\n  const targetMethodJsonDescription = [{ name: 'foo' }]\n  const targetParams = [8]\n  const mockTransaction = { to: targetAddress, data: '0x123' }\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  instance.accounts = of('0x00')\n  instance.apps = of([\n    {\n      appId: 'counterApp',\n      kernelAddress: '0x789',\n      abi: 'abi for counterApp',\n      proxyAddress: '0x456'\n    }\n  ])\n  instance.describeTransactionPath = sinon.stub().returnsArg(0)\n  utilsStub.transactions.createDirectTransaction = sinon.stub().returns(mockTransaction)\n  // act\n  const externalPath = await instance.getExternalTransactionPath(targetAddress, targetMethodJsonDescription, targetParams)\n  // assert\n  t.deepEqual(externalPath, [mockTransaction])\n})\n\ntest('should run the app and reply to a request', async (t) => {\n  const { createAragon, messengerConstructorStub, utilsStub } = t.context\n\n  // Note: This is not a \"real\" unit test because the rpc handlers are not mocked\n  t.plan(4)\n  // arrange\n  const requestsStub = of({\n    id: 'uuid1',\n    method: 'cache',\n    params: ['get', 'settings']\n  })\n  const messengerStub = {\n    sendResponse: sinon.stub(),\n    requests: () => requestsStub\n  }\n  messengerConstructorStub.withArgs('someMessageProvider').returns(messengerStub)\n\n  const instance = createAragon()\n  instance.cache.get = sinon.stub()\n    .withArgs('0x789.settings')\n    .returns(of('user settings for the voting app'))\n  instance.apps = of([\n    {\n      appId: 'some other app with a different proxy',\n      proxyAddress: '0x456'\n    }, {\n      appId: 'votingApp',\n      kernelAddress: '0x123',\n      abi: 'abi for votingApp',\n      proxyAddress: '0x789'\n    }\n  ])\n  utilsStub.makeProxyFromAppABI = (proxyAddress) => ({\n    address: proxyAddress,\n    updateInitializationBlock: () => {}\n  })\n  instance.kernelProxy = { initializationBlock: 0 }\n  // act\n  const connect = await instance.runApp('0x789')\n  const result = connect('someMessageProvider')\n  // assert\n  t.true(result.shutdown !== undefined)\n  t.true(result.shutdownAndClearCache !== undefined)\n  /**\n   * What we're testing here is that the request for getting the cache (messenger.requests())\n   * is handled by the appropriate requestHandler.\n   */\n  t.is(messengerStub.sendResponse.getCall(0).args[0], 'uuid1')\n  t.is(messengerStub.sendResponse.getCall(0).args[1], 'user settings for the voting app')\n})\n\ntest('should run the app and be able to shutdown', async (t) => {\n  const { createAragon, messengerConstructorStub, utilsStub } = t.context\n\n  // Note: This is not a \"real\" unit test because the rpc handlers are not mocked\n  t.plan(1)\n  // arrange\n  const requestsStub = new Subject()\n  const messengerStub = {\n    sendResponse: sinon.stub(),\n    requests: () => requestsStub\n  }\n  messengerConstructorStub.withArgs('someMessageProvider').returns(messengerStub)\n\n  const instance = createAragon()\n  instance.apps = of([\n    {\n      appId: 'some other app with a different proxy',\n      proxyAddress: '0x456'\n    }, {\n      appId: 'votingApp',\n      kernelAddress: '0x123',\n      abi: 'abi for votingApp',\n      proxyAddress: '0x789'\n    }\n  ])\n  // Mimic never-ending stream\n  instance.accounts = new ReplaySubject(1)\n  instance.accounts.next('0x00')\n\n  utilsStub.makeProxyFromAppABI = (proxyAddress) => ({\n    address: proxyAddress,\n    updateInitializationBlock: () => {}\n  })\n  instance.kernelProxy = { initializationBlock: 0 }\n\n  // act\n  const connect = await instance.runApp('0x789')\n  const result = connect('someMessageProvider')\n\n  // send one message\n  requestsStub.next({\n    id: 'uuid1',\n    method: 'accounts'\n  })\n\n  // shutdown\n  result.shutdown()\n\n  // should not handle message after shutdown\n  requestsStub.next({\n    id: 'uuid2',\n    method: 'accounts'\n  })\n\n  // assert\n  // test that we've only handled messages before the handlers were shutdown\n  t.is(messengerStub.sendResponse.callCount, 1)\n})\n\ntest('should run the app and be able to shutdown and clear cache', async (t) => {\n  const { createAragon, messengerConstructorStub, utilsStub } = t.context\n  const runningProxyAddress = '0x789'\n\n  // Note: This is not a \"real\" unit test because the rpc handlers are not mocked\n  t.plan(2)\n  // arrange\n  const requestsStub = new Subject()\n  const messengerStub = {\n    sendResponse: sinon.stub(),\n    requests: () => requestsStub\n  }\n  messengerConstructorStub.withArgs('someMessageProvider').returns(messengerStub)\n\n  const instance = createAragon()\n  instance.apps = of([\n    {\n      appId: 'some other app with a different proxy',\n      proxyAddress: '0x456'\n    }, {\n      appId: 'votingApp',\n      kernelAddress: '0x123',\n      abi: 'abi for votingApp',\n      proxyAddress: runningProxyAddress\n    }\n  ])\n  // Mimic never-ending stream\n  instance.accounts = new ReplaySubject(1)\n  instance.accounts.next('0x00')\n\n  utilsStub.makeProxyFromAppABI = (proxyAddress) => ({\n    address: proxyAddress,\n    updateInitializationBlock: () => {}\n  })\n  instance.kernelProxy = { initializationBlock: 0 }\n\n  // set up cache\n  await instance.cache.init()\n  await instance.cache.set(`${runningProxyAddress}.key1`, 'value1')\n  await instance.cache.set(`${runningProxyAddress}.key2`, 'value2')\n  await instance.cache.set('alternative.key', 'alternative value')\n\n  // act\n  const connect = await instance.runApp(runningProxyAddress)\n  const result = connect('someMessageProvider')\n\n  // send one message\n  requestsStub.next({\n    id: 'uuid1',\n    method: 'accounts'\n  })\n\n  // shutdown and clear cache\n  await result.shutdownAndClearCache()\n\n  // should not handle message after shutdown\n  requestsStub.next({\n    id: 'uuid2',\n    method: 'accounts'\n  })\n\n  // assert\n  // test that we've only handled messages before the handlers were shutdown\n  t.is(messengerStub.sendResponse.callCount, 1)\n  // test that we've cleared the cache for the running app\n  t.true(Object.keys(await instance.cache.getAll()).every(key => !key.startsWith(runningProxyAddress)))\n})\n\ntest('should get the app from a proxy address', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  instance.apps = of([\n    {\n      appId: 'some other app with a different proxy',\n      proxyAddress: '0x456'\n    }, {\n      appId: 'votingApp',\n      kernelAddress: '0x123',\n      abi: 'abi for votingApp',\n      proxyAddress: '0x789'\n    }\n  ])\n  // act\n  const result = await instance.getApp('0x789')\n  // assert\n  t.deepEqual(result, {\n    appId: 'votingApp',\n    kernelAddress: '0x123',\n    abi: 'abi for votingApp',\n    proxyAddress: '0x789'\n  })\n})\n\ntest('should get the permission manager', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  instance.permissions = of({\n    counter: {\n      add: {\n        allowedEntities: ['0x1', '0x2']\n      },\n      subtract: {\n        allowedEntities: ['0x1'],\n        manager: 'im manager'\n      }\n    }\n  })\n  // act\n  const result = await instance.getPermissionManager('counter', 'subtract')\n  // assert\n  t.is(result, 'im manager')\n})\n\ntest('should be able to decode an evm call script with a single transaction', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  const script = encodeCallScript([{\n    to: '0xcafe1a77e84698c83ca8931f54a755176ef75f2c',\n    data: '0xcafe'\n  }])\n  // act\n  const decodedScript = instance.decodeTransactionPath(script)\n  // assert\n  t.deepEqual(decodedScript, [\n    {\n      data: '0xcafe',\n      to: '0xcafe1a77e84698c83ca8931f54a755176ef75f2c'\n    }\n  ])\n})\n\ntest('should be able to decode an evm call script with multiple transactions', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  const script = encodeCallScript([{\n    to: '0xcafe1a77e84698c83ca8931f54a755176ef75f2c',\n    data: '0xcafe'\n  }, {\n    to: '0xbeefbeef03c7e5a1c29e0aa675f8e16aee0a5fad',\n    data: '0xbeef'\n  }, {\n    to: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n    data: '0x'\n  }])\n  // act\n  const decodedScript = instance.decodeTransactionPath(script)\n  // assert\n  t.deepEqual(decodedScript, [\n    {\n      to: '0xcafe1a77e84698c83ca8931f54a755176ef75f2c',\n      data: '0xcafe'\n    }, {\n      to: '0xbeefbeef03c7e5a1c29e0aa675f8e16aee0a5fad',\n      data: '0xbeef'\n    }, {\n      to: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n      data: '0x'\n    }\n  ])\n})\n\ntest('should init the appMetadata correctly', async (t) => {\n  t.plan(1)\n  // arrange\n  const { Aragon } = t.context\n  const instance = new Aragon()\n  instance.cache.get = sinon.stub().returns({})\n  // act\n  await instance.initAppMetadata()\n  // assert\n  instance.appMetadata.subscribe(value => {\n    console.log('value: ', value)\n    t.deepEqual(value, {})\n  })\n})\n\ntest('should add metadata items', async (t) => {\n  t.plan(2)\n  const { Aragon } = t.context\n  const instance = new Aragon()\n  instance.cache.get = sinon.stub().returns({})\n  // act\n  await instance.initAppMetadata()\n  instance.registerAppMetadata(\n    '0x73a',\n    '10',\n    'u1',\n    'Qmrandomhash1',\n    ['0xdeadcafe']\n  )\n\n  // assert\n  instance.appMetadata.pipe(first()).subscribe(value => {\n    t.deepEqual(value, {\n      '0x73a,u1': {\n        from: '0x73a',\n        dataId: 'u1',\n        cid: 'Qmrandomhash1',\n        to: ['0xdeadcafe']\n      }\n    })\n  })\n\n  // act\n  // 'to' parameter should be defaulted to '*'\n  instance.registerAppMetadata(\n    '0x73a',\n    '11',\n    'v2',\n    'Qmrandomhash2'\n  )\n\n  // assert\n  instance.appMetadata.pipe(first()).subscribe(value => {\n    t.deepEqual(value, {\n      '0x73a,u1': {\n        from: '0x73a',\n        dataId: 'u1',\n        cid: 'Qmrandomhash1',\n        to: ['0xdeadcafe']\n      },\n      '0x73a,v2': {\n        from: '0x73a',\n        dataId: 'v2',\n        cid: 'Qmrandomhash2',\n        to: ['*']\n      }\n    })\n  })\n})\n\ntest('should init the forwarded actions correctly', async (t) => {\n  t.plan(1)\n  // arrange\n  const { Aragon } = t.context\n  const instance = new Aragon()\n  instance.cache.get = sinon.stub().returns({})\n  // act\n  await instance.initForwardedActions()\n  // assert\n  instance.forwardedActions.subscribe(value => {\n    console.log('value: ', value)\n    t.deepEqual(value, {})\n  })\n})\n\ntest('should forbid forwarding action with invalid status', async (t) => {\n  // arrange\n  const { Aragon } = t.context\n  const instance = new Aragon()\n  instance.cache.get = sinon.stub().returns({})\n  instance.cache.set = sinon.stub().resolves()\n  const target = '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad'\n  const script = encodeCallScript([{ to: target, data: '0x' }])\n  await instance.initForwardedActions()\n\n  // act & assert\n  t.throws(\n    () => instance.setForwardedAction({\n      currentApp: '0x0',\n      actionId: '1',\n      blockNumber: Number.POSITIVE_INFINITY,\n      evmScript: script,\n      status: 'koala'\n    }),\n    /unexpected status/\n  )\n\n  // act, circumventing best practices\n  instance.forwardedActions.next({\n    currentApp: '0x0',\n    actionId: '1',\n    blockNumber: Number.POSITIVE_INFINITY,\n    evmScript: script,\n    target,\n    status: 'koala'\n  })\n\n  // assert\n  instance.forwardedActions.pipe(first()).subscribe(value => {\n    t.deepEqual(value, {})\n  })\n})\n\ntest('should forbid forwarding action without blockNumber', async (t) => {\n  // arrange\n  const { Aragon } = t.context\n  const instance = new Aragon()\n  instance.cache.get = sinon.stub().returns({})\n  await instance.initForwardedActions()\n  const target = '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad'\n  const evmScript = encodeCallScript([{ to: target, data: '0x' }])\n\n  // act & assert\n  t.throws(\n    () => instance.setForwardedAction({\n      currentApp: '0x0',\n      actionId: '1',\n      evmScript,\n      target\n    }),\n    /must provide blockNumber/\n  )\n\n  // act, circumventing best practices\n  instance.forwardedActions.next({\n    currentApp: '0x0',\n    actionId: '1',\n    evmScript,\n    target\n  })\n\n  // assert\n  instance.forwardedActions.pipe(first()).subscribe(value => {\n    t.deepEqual(value, {})\n  })\n})\n\ntest('should forbid forwarding action with invalid evmScript', async (t) => {\n  // arrange\n  const { Aragon } = t.context\n  const instance = new Aragon()\n  instance.cache.get = sinon.stub().returns({})\n  instance.cache.set = sinon.stub().resolves()\n  await instance.initForwardedActions()\n\n  // act & assert\n  t.throws(\n    () => instance.setForwardedAction({\n      currentApp: '0x0',\n      actionId: '1',\n      blockNumber: Number.POSITIVE_INFINITY\n    }),\n    /must provide a valid evmScript/\n  )\n  t.throws(\n    () => instance.setForwardedAction({\n      currentApp: '0x0',\n      actionId: '1',\n      blockNumber: Number.POSITIVE_INFINITY,\n      evmScript: 'nonsense'\n    }),\n    /Script could not be decoded/\n  )\n\n  // act, circumventing best practices\n  instance.forwardedActions.next({\n    currentApp: '0x0',\n    actionId: '1',\n    blockNumber: Number.POSITIVE_INFINITY,\n    evmScript: 'lololol',\n    target: null\n  })\n\n  // assert\n  instance.forwardedActions.pipe(first()).subscribe(value => {\n    t.deepEqual(value, {})\n  })\n})\n\ntest('should set forwarded actions', async (t) => {\n  // arrange\n  const { Aragon } = t.context\n  const instance = new Aragon()\n  instance.cache.get = sinon.stub().returns({})\n  instance.cache.set = sinon.stub().resolves()\n  const script = encodeCallScript([{\n    to: '0xcafe1a77e84698c83ca8931f54a755176ef75f2c',\n    data: '0xcafe25'\n  }, {\n    to: '0xbeefbeef03c7e5a1c29e0aa675f8e16aee0a5fad',\n    data: '0xbeef'\n  }, {\n    to: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n    data: '0x'\n  }])\n\n  // act\n  await instance.initForwardedActions()\n  instance.setForwardedAction({\n    currentApp: '0x0',\n    actionId: '1',\n    blockNumber: Number.POSITIVE_INFINITY,\n    evmScript: script\n  })\n\n  // assert\n  instance.forwardedActions.pipe(first()).subscribe(value => {\n    t.deepEqual(value, { '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad': {\n      completedActionKeys: [],\n      failedActionKeys: [],\n      pendingActionKeys: ['0x0,1'],\n      actions: {\n        '0x0,1': {\n          currentApp: '0x0',\n          actionId: '1',\n          evmScript: script,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'pending'\n        } } } })\n  })\n\n  // update existing entry\n  // arrange\n  const newScript = encodeCallScript([{\n    to: '0xcafe1a77e84698c83ca8931f54a755176ef75f2c',\n    data: '0xcafe25'\n  }, {\n    to: '0xbeefbeef03c7e5a1c29e0aa675f8e16aee0a5fad',\n    data: '0xbeef'\n  }, {\n    to: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n    data: '0xdeadbeef'\n  }])\n  // act\n  instance.setForwardedAction({\n    currentApp: '0x0',\n    actionId: '1',\n    blockNumber: Number.POSITIVE_INFINITY,\n    evmScript: newScript\n  })\n  // assert\n  instance.forwardedActions.pipe(first()).subscribe(value => {\n    t.deepEqual(value, { '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad': {\n      completedActionKeys: [],\n      failedActionKeys: [],\n      pendingActionKeys: ['0x0,1'],\n      actions: {\n        '0x0,1': {\n          currentApp: '0x0',\n          actionId: '1',\n          evmScript: newScript,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'pending'\n        } } } })\n  })\n\n  // add multiple entries\n  // act\n  instance.setForwardedAction({\n    currentApp: '0x0',\n    actionId: '2',\n    blockNumber: Number.POSITIVE_INFINITY,\n    evmScript: script\n  })\n  instance.setForwardedAction({\n    currentApp: '0x0',\n    actionId: '3',\n    blockNumber: Number.POSITIVE_INFINITY,\n    evmScript: script\n  })\n  // assert\n  instance.forwardedActions.pipe(first()).subscribe(value => {\n    t.deepEqual(value['0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad'], {\n      completedActionKeys: [],\n      failedActionKeys: [],\n      pendingActionKeys: ['0x0,1', '0x0,2', '0x0,3'],\n      actions: {\n        '0x0,1': {\n          currentApp: '0x0',\n          actionId: '1',\n          evmScript: newScript,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'pending'\n        },\n        '0x0,2': {\n          currentApp: '0x0',\n          actionId: '2',\n          evmScript: script,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'pending'\n        },\n        '0x0,3': {\n          currentApp: '0x0',\n          actionId: '3',\n          evmScript: script,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'pending'\n        } } })\n  })\n\n  // set entry as completed\n  // act\n  instance.setForwardedAction({\n    currentApp: '0x0',\n    actionId: '2',\n    blockNumber: Number.POSITIVE_INFINITY,\n    evmScript: script,\n    status: 'completed'\n  })\n  // assert\n  instance.forwardedActions.pipe(first()).subscribe(value => {\n    t.deepEqual(value['0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad'], {\n      completedActionKeys: ['0x0,2'],\n      failedActionKeys: [],\n      pendingActionKeys: ['0x0,1', '0x0,3'],\n      actions: {\n        '0x0,1': {\n          currentApp: '0x0',\n          actionId: '1',\n          evmScript: newScript,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'pending'\n        },\n        '0x0,2': {\n          currentApp: '0x0',\n          actionId: '2',\n          evmScript: script,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'completed'\n        },\n        '0x0,3': {\n          currentApp: '0x0',\n          actionId: '3',\n          evmScript: script,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'pending'\n        } } })\n  })\n\n  // act\n  // set entry as failed\n  instance.setForwardedAction({\n    currentApp: '0x0',\n    actionId: '3',\n    blockNumber: Number.POSITIVE_INFINITY,\n    evmScript: script,\n    status: 'failed'\n  })\n  // attempt to change the completed entry back to pending\n  // this should not change any state\n  instance.setForwardedAction({\n    currentApp: '0x0',\n    actionId: '2',\n    blockNumber: Number.POSITIVE_INFINITY,\n    evmScript: script,\n    status: 'pending'\n  })\n\n  // assert\n  instance.forwardedActions.pipe(first()).subscribe(value => {\n    t.deepEqual(value['0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad'], {\n      pendingActionKeys: ['0x0,1'],\n      completedActionKeys: ['0x0,2'],\n      failedActionKeys: ['0x0,3'],\n      actions: {\n        '0x0,1': {\n          currentApp: '0x0',\n          actionId: '1',\n          evmScript: newScript,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'pending'\n        },\n        '0x0,2': {\n          currentApp: '0x0',\n          actionId: '2',\n          evmScript: script,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'completed'\n        },\n        '0x0,3': {\n          currentApp: '0x0',\n          actionId: '3',\n          evmScript: script,\n          target: '0xbaaabaaa03c7e5a1c29e0aa675f8e16aee0a5fad',\n          status: 'failed'\n        } } })\n  })\n})\n\ntest('should cache forwarded actions', async (t) => {\n  // arrange\n  const babaAddress = '0xbaaaaaaaaabaaaaaaaaabaaaaaaaaabaaaaaaaaa'\n  const babaScript = encodeCallScript([{ to: babaAddress, data: '0x' }])\n  const babaStored = {\n    [babaAddress]: {\n      pendingActionKeys: ['0x0,1'],\n      completedActionKeys: [],\n      failedActionKeys: [],\n      actions: {\n        '0x0,1': {\n          currentApp: '0x0',\n          actionId: '1',\n          evmScript: babaScript,\n          target: babaAddress,\n          status: 'pending'\n        }\n      }\n    }\n  }\n  const { Aragon } = t.context\n  const instance = new Aragon()\n  instance.cache.get = sinon.stub().withArgs('forwardedActions').returns({ ...babaStored })\n  instance.cache.set = sinon.stub().resolves()\n  await instance.initForwardedActions({ cacheBlockHeight: 10 })\n\n  // act\n\n  // no caching if blockNumber ≥ cacheBlockHeight\n  const dadaAddress = '0xdaaaaaaaaadaaaaaaaaadaaaaaaaaadaaaaaaaaa'\n  const dadaScript = encodeCallScript([{ to: dadaAddress, data: '0x' }])\n  instance.setForwardedAction({\n    blockNumber: 10,\n    currentApp: '0x0',\n    actionId: '3',\n    evmScript: dadaScript\n  })\n\n  // yes, caching, if blockNumber < cacheBlockHeight\n  const eaeaAddress = '0xeaaaaaaaaaeaaaaaaaaaeaaaaaaaaaeaaaaaaaaa'\n  const eaeaScript = encodeCallScript([{ to: eaeaAddress, data: '0x' }])\n  instance.setForwardedAction({\n    blockNumber: 9,\n    currentApp: '0x0',\n    actionId: '4',\n    evmScript: eaeaScript\n  })\n\n  // also cached\n  const fafaAddress = '0xfaaaaaaaaafaaaaaaaaafaaaaaaaaafaaaaaaaaa'\n  const fafaScript = encodeCallScript([{ to: fafaAddress, data: '0x' }])\n  instance.setForwardedAction({\n    blockNumber: 9,\n    currentApp: '0x0',\n    actionId: '5',\n    evmScript: fafaScript\n  })\n\n  // assert\n  const dadaStored = {\n    [dadaAddress]: {\n      pendingActionKeys: ['0x0,3'],\n      completedActionKeys: [],\n      failedActionKeys: [],\n      actions: {\n        '0x0,3': {\n          currentApp: '0x0',\n          actionId: '3',\n          evmScript: dadaScript,\n          target: dadaAddress,\n          status: 'pending'\n        }\n      }\n    }\n  }\n  const eaeaStored = {\n    [eaeaAddress]: {\n      pendingActionKeys: ['0x0,4'],\n      completedActionKeys: [],\n      failedActionKeys: [],\n      actions: {\n        '0x0,4': {\n          currentApp: '0x0',\n          actionId: '4',\n          evmScript: eaeaScript,\n          target: eaeaAddress,\n          status: 'pending'\n        }\n      }\n    }\n  }\n  const fafaStored = {\n    [fafaAddress]: {\n      pendingActionKeys: ['0x0,5'],\n      completedActionKeys: [],\n      failedActionKeys: [],\n      actions: {\n        '0x0,5': {\n          currentApp: '0x0',\n          actionId: '5',\n          evmScript: fafaScript,\n          target: fafaAddress,\n          status: 'pending'\n        }\n      }\n    }\n  }\n  instance.forwardedActions.pipe(first()).subscribe(value => {\n    // protect against poorly-written tests; the cache test is a false positive if this fails\n    t.notDeepEqual(babaStored, { ...babaStored, ...dadaStored, ...eaeaStored, ...fafaStored })\n\n    t.deepEqual(value, { ...babaStored, ...dadaStored, ...eaeaStored, ...fafaStored })\n    t.is(instance.cache.set.getCall(0).args[0], 'forwardedActions')\n    t.deepEqual(instance.cache.set.getCall(0).args[1], { ...babaStored, ...eaeaStored, ...fafaStored })\n  })\n})\n\ntest('should be able to decode an evm call script with multiple nested transactions', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  /* eslint-disable no-multi-spaces */\n  const script = encodeCallScript([{\n    to: '0xbfd1f54dc1c3b50ddf2f1d5fe2f8a6b9c29bb598',\n    data: '0x' +\n          'd948d468' +                                                            // forward signature\n          '0000000000000000000000000000000000000000000000000000000000000020' +    // offset\n          '0000000000000000000000000000000000000000000000000000000000000060' +    // 96 data bytes length\n          '00000001' +                                                            // spec id\n          '14a3208711873b6aab2005f6cca0f91658e287ef' +                            // forward target\n          '00000044' +                                                            // 68 data bytes length\n          '40c10f19' +                                                            // mint\n          '000000000000000000000000b4124cEB3451635DAcedd11767f004d8a28c6eE7' +    // token holder\n          '0000000000000000000000000000000000000000000000003782dace9d900000'      // 4e18\n  }, {\n    to: '0x634faa183ba1f5f968cb96656d24dff66021f5a2',\n    data: '0x' +\n          'd948d468' +                                                            // forward signature\n          '0000000000000000000000000000000000000000000000000000000000000020' +    // offset\n          '00000000000000000000000000000000000000000000000000000000000000c0' +    // 192 data bytes length\n          '00000001' +                                                            // spec id\n          '14a3208711873b6aab2005f6cca0f91658e287ef' +                            // forward target\n          '000000a4' +                                                            // 164 data bytes length\n          'bfe07da6' +                                                            // deposit\n          '0000000000000000000000008401eb5ff34cc943f096a32ef3d5113febe8d4eb' +    // token holder\n          '0000000000000000000000000000000000000000000000000de0b6b3a7640000' +    // 1e18\n          '0000000000000000000000000000000000000000000000000000000000000020' +    // 1 word\n          '0000000000000000000000000000000000000000000000000000000000000004' +    // 4 bytes\n          '4141414100000000000000000000000000000000000000000000000000000000'      // \"AAAA\" encoded\n  }])\n  /* eslint-enable no-multi-spaces */\n  // act\n  const decodedScript = instance.decodeTransactionPath(script)\n  // assert\n  t.deepEqual(decodedScript, [\n    {\n      to: '0xbfd1f54dc1c3b50ddf2f1d5fe2f8a6b9c29bb598',\n      data: '0x' +\n            'd948d468' +\n            '0000000000000000000000000000000000000000000000000000000000000020' +\n            '0000000000000000000000000000000000000000000000000000000000000060' +\n            '00000001' +\n            '14a3208711873b6aab2005f6cca0f91658e287ef' +\n            '00000044' +\n            '40c10f19' +\n            '000000000000000000000000b4124cEB3451635DAcedd11767f004d8a28c6eE7' +\n            '0000000000000000000000000000000000000000000000003782dace9d900000',\n      children: [{\n        data: '0x' +\n            '40c10f19' +\n            '000000000000000000000000b4124cEB3451635DAcedd11767f004d8a28c6eE7' +\n            '0000000000000000000000000000000000000000000000003782dace9d900000',\n        to: '0x14a3208711873b6aab2005f6cca0f91658e287ef'\n      }]\n    }, {\n      to: '0x634faa183ba1f5f968cb96656d24dff66021f5a2',\n      data: '0x' +\n            'd948d468' +\n            '0000000000000000000000000000000000000000000000000000000000000020' +\n            '00000000000000000000000000000000000000000000000000000000000000c0' +\n            '00000001' +\n            '14a3208711873b6aab2005f6cca0f91658e287ef' +\n            '000000a4' +\n            'bfe07da6' +\n            '0000000000000000000000008401eb5ff34cc943f096a32ef3d5113febe8d4eb' +\n            '0000000000000000000000000000000000000000000000000de0b6b3a7640000' +\n            '0000000000000000000000000000000000000000000000000000000000000020' +\n            '0000000000000000000000000000000000000000000000000000000000000004' +\n            '4141414100000000000000000000000000000000000000000000000000000000',\n      children: [{\n        data: '0x' +\n              'bfe07da6' +\n              '0000000000000000000000008401eb5ff34cc943f096a32ef3d5113febe8d4eb' +\n              '0000000000000000000000000000000000000000000000000de0b6b3a7640000' +\n              '0000000000000000000000000000000000000000000000000000000000000020' +\n              '0000000000000000000000000000000000000000000000000000000000000004' +\n              '4141414100000000000000000000000000000000000000000000000000000000',\n        to: '0x14a3208711873b6aab2005f6cca0f91658e287ef'\n      }]\n    }\n  ])\n})\n\ntest('should be able to decode an evm call script with a complex nested transaction', async (t) => {\n  const { createAragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  /* eslint-disable no-multi-spaces */\n  const nestedScript =\n    encodeCallScript([{\n      to: '0xbfd1f54dc1c3b50ddf2f1d5fe2f8a6b9c29bb598',\n      data: '0x' +\n            'd948d468' +                                                            // forward signature\n            '0000000000000000000000000000000000000000000000000000000000000020' +    // offset\n            '0000000000000000000000000000000000000000000000000000000000000060' +    // 96 data bytes length\n            '00000001' +                                                            // spec id\n            '14a3208711873b6aab2005f6cca0f91658e287ef' +                            // forward target\n            '00000044' +                                                            // 68 data bytes length\n            '40c10f19' +                                                            // mint\n            '000000000000000000000000b4124cEB3451635DAcedd11767f004d8a28c6eE7' +    // token holder\n            '0000000000000000000000000000000000000000000000003782dace9d900000'      // 4e18\n    }, {\n      to: '0x634faa183ba1f5f968cb96656d24dff66021f5a2',\n      data: '0x' +\n            'd948d468' +                                                            // forward signature\n            '0000000000000000000000000000000000000000000000000000000000000020' +    // offset\n            '00000000000000000000000000000000000000000000000000000000000000c0' +    // 192 data bytes length\n            '00000001' +                                                            // spec id\n            '14a3208711873b6aab2005f6cca0f91658e287ef' +                            // forward target\n            '000000a4' +                                                            // 164 data bytes length\n            'bfe07da6' +                                                            // deposit\n            '0000000000000000000000008401eb5ff34cc943f096a32ef3d5113febe8d4eb' +    // token holder\n            '0000000000000000000000000000000000000000000000000de0b6b3a7640000' +    // 1e18\n            '0000000000000000000000000000000000000000000000000000000000000020' +    // 1 word\n            '0000000000000000000000000000000000000000000000000000000000000004' +    // 4 bytes\n            '4141414100000000000000000000000000000000000000000000000000000000'      // \"AAAA\" encoded\n    }]).substring(2)                                                                   // cut off '0x' prefix\n  // Divide by 2 for hex, convert number into hex string, and pad for uint256\n  const nestedScriptDataLength = `${(nestedScript.length / 2).toString(16)}`.padStart(64, 0)\n  const script = encodeCallScript([{\n    to: '0x62451b8705e6691b92afaa7766c0722c93a0e204',\n    data: '0x' +\n          'd948d468' +                                                            // forward signature\n          '0000000000000000000000000000000000000000000000000000000000000020' +    // offset\n          nestedScriptDataLength +                                                // previous script data bytes length\n          nestedScript                                                            // previous script data\n  }])\n  /* eslint-enable no-multi-spaces */\n  // act\n  const decodedScript = instance.decodeTransactionPath(script)\n  // assert\n  t.deepEqual(decodedScript, [\n    {\n      to: '0x62451b8705e6691b92afaa7766c0722c93a0e204',\n      data: '0x' +\n            'd948d468' +\n            '0000000000000000000000000000000000000000000000000000000000000020' +\n            nestedScriptDataLength +\n            nestedScript,\n      children: [\n        {\n          to: '0xbfd1f54dc1c3b50ddf2f1d5fe2f8a6b9c29bb598',\n          data: '0x' +\n                'd948d468' +\n                '0000000000000000000000000000000000000000000000000000000000000020' +\n                '0000000000000000000000000000000000000000000000000000000000000060' +\n                '00000001' +\n                '14a3208711873b6aab2005f6cca0f91658e287ef' +\n                '00000044' +\n                '40c10f19' +\n                '000000000000000000000000b4124cEB3451635DAcedd11767f004d8a28c6eE7' +\n                '0000000000000000000000000000000000000000000000003782dace9d900000',\n          children: [{\n            data: '0x' +\n                '40c10f19' +\n                '000000000000000000000000b4124cEB3451635DAcedd11767f004d8a28c6eE7' +\n                '0000000000000000000000000000000000000000000000003782dace9d900000',\n            to: '0x14a3208711873b6aab2005f6cca0f91658e287ef'\n          }]\n        }, {\n          to: '0x634faa183ba1f5f968cb96656d24dff66021f5a2',\n          data: '0x' +\n                'd948d468' +\n                '0000000000000000000000000000000000000000000000000000000000000020' +\n                '00000000000000000000000000000000000000000000000000000000000000c0' +\n                '00000001' +\n                '14a3208711873b6aab2005f6cca0f91658e287ef' +\n                '000000a4' +\n                'bfe07da6' +\n                '0000000000000000000000008401eb5ff34cc943f096a32ef3d5113febe8d4eb' +\n                '0000000000000000000000000000000000000000000000000de0b6b3a7640000' +\n                '0000000000000000000000000000000000000000000000000000000000000020' +\n                '0000000000000000000000000000000000000000000000000000000000000004' +\n                '4141414100000000000000000000000000000000000000000000000000000000',\n          children: [{\n            data: '0x' +\n                  'bfe07da6' +\n                  '0000000000000000000000008401eb5ff34cc943f096a32ef3d5113febe8d4eb' +\n                  '0000000000000000000000000000000000000000000000000de0b6b3a7640000' +\n                  '0000000000000000000000000000000000000000000000000000000000000020' +\n                  '0000000000000000000000000000000000000000000000000000000000000004' +\n                  '4141414100000000000000000000000000000000000000000000000000000000',\n            to: '0x14a3208711873b6aab2005f6cca0f91658e287ef'\n          }]\n        }\n      ]\n    }\n  ])\n})\n\ntest('should not decode non-call scripts', async (t) => {\n  const { createAragon } = t.context\n  const badSpecId = '0x00000002'\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  const script = `${badSpecId}${'123'.padStart(64, 0)}`\n  // assert\n  t.throws(\n    () => instance.decodeTransactionPath(script),\n    {\n      instanceOf: Error,\n      message: `Script could not be decoded: ${script}`\n    }\n  )\n})\n\ntest('should be only able to decode call scripts when there are multiple nested transactions', async (t) => {\n  const { createAragon } = t.context\n  const badSpecId = '0x00000002'\n\n  t.plan(1)\n  // arrange\n  const instance = createAragon()\n  /* eslint-disable no-multi-spaces */\n  const script = encodeCallScript([{\n    to: '0xbfd1f54dc1c3b50ddf2f1d5fe2f8a6b9c29bb598',\n    data: '0x' +\n          'd948d468' +                                                            // forward signature\n          '0000000000000000000000000000000000000000000000000000000000000020' +    // offset\n          '0000000000000000000000000000000000000000000000000000000000000060' +    // 96 data bytes length\n          '00000001' +                                                            // spec id\n          '14a3208711873b6aab2005f6cca0f91658e287ef' +                            // forward target\n          '00000044' +                                                            // 68 data bytes length\n          '40c10f19' +                                                            // mint\n          '000000000000000000000000b4124cEB3451635DAcedd11767f004d8a28c6eE7' +    // token holder\n          '0000000000000000000000000000000000000000000000003782dace9d900000'      // 4e18\n  }, {\n    to: '0x634faa183ba1f5f968cb96656d24dff66021f5a2',\n    data: '0x' +\n          'd948d468' +                                                            // forward signature\n          '0000000000000000000000000000000000000000000000000000000000000020' +    // offset\n          '00000000000000000000000000000000000000000000000000000000000000c0' +    // 192 data bytes length\n          badSpecId.substring(2) +                                                // **BAD SPEC ID**\n          '14a3208711873b6aab2005f6cca0f91658e287ef' +                            // forward target\n          '000000a4' +                                                            // 164 data bytes length\n          'bfe07da6' +                                                            // deposit\n          '0000000000000000000000008401eb5ff34cc943f096a32ef3d5113febe8d4eb' +    // token holder\n          '0000000000000000000000000000000000000000000000000de0b6b3a7640000' +    // 1e18\n          '0000000000000000000000000000000000000000000000000000000000000020' +    // 1 word\n          '0000000000000000000000000000000000000000000000000000000000000004' +    // 4 bytes\n          '4141414100000000000000000000000000000000000000000000000000000000'      // \"AAAA\" encoded\n  }])\n  /* eslint-enable no-multi-spaces */\n  // act\n  const decodedScript = instance.decodeTransactionPath(script)\n  // assert\n  t.deepEqual(decodedScript, [\n    {\n      to: '0xbfd1f54dc1c3b50ddf2f1d5fe2f8a6b9c29bb598',\n      data: '0x' +\n            'd948d468' +\n            '0000000000000000000000000000000000000000000000000000000000000020' +\n            '0000000000000000000000000000000000000000000000000000000000000060' +\n            '00000001' +\n            '14a3208711873b6aab2005f6cca0f91658e287ef' +\n            '00000044' +\n            '40c10f19' +\n            '000000000000000000000000b4124cEB3451635DAcedd11767f004d8a28c6eE7' +\n            '0000000000000000000000000000000000000000000000003782dace9d900000',\n      children: [{\n        data: '0x' +\n            '40c10f19' +\n            '000000000000000000000000b4124cEB3451635DAcedd11767f004d8a28c6eE7' +\n            '0000000000000000000000000000000000000000000000003782dace9d900000',\n        to: '0x14a3208711873b6aab2005f6cca0f91658e287ef'\n      }]\n    },\n    {\n      to: '0x634faa183ba1f5f968cb96656d24dff66021f5a2',\n      data: '0x' +\n            'd948d468' +\n            '0000000000000000000000000000000000000000000000000000000000000020' +\n            '00000000000000000000000000000000000000000000000000000000000000c0' +\n            badSpecId.substring(2) +\n            '14a3208711873b6aab2005f6cca0f91658e287ef' +\n            '000000a4' +\n            'bfe07da6' +\n            '0000000000000000000000008401eb5ff34cc943f096a32ef3d5113febe8d4eb' +\n            '0000000000000000000000000000000000000000000000000de0b6b3a7640000' +\n            '0000000000000000000000000000000000000000000000000000000000000020' +\n            '0000000000000000000000000000000000000000000000000000000000000004' +\n            '4141414100000000000000000000000000000000000000000000000000000000'\n      // ignores the second target's children because it's not a call script forward\n    }\n  ])\n})\n\ntest('should create trigger events', async (t) => {\n  const { Aragon } = t.context\n\n  t.plan(1)\n  // arrange\n  const instance = new Aragon()\n  instance.trigger = new Subject()\n  instance.trigger.subscribe(value => {\n    t.deepEqual(value, {\n      origin: '0x0',\n      frontendEvent: {\n        event: 'TriggerTest',\n        returnValues: {\n          testval: 1\n        }\n      }\n    })\n  })\n  // act and assert\n  instance.triggerAppStore('0x0', 'TriggerTest', { testval: 1 })\n})\n"],"file":"index.test.js"}